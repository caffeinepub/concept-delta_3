{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix Admin link not visible in Navbar for admin users",
  "requirements": [
    {
      "id": "REQ-37",
      "summary": "Rewrite Admin link visibility logic in Navbar.tsx to use unconditional useGetCallerUserProfile when authenticated, unwrap the Option profile correctly, derive showAdmin from profile.isAdmin, and render the Admin link in both desktop and mobile menus on all routes without any route-based guards",
      "acceptanceCriteria": [
        "An authenticated user with isAdmin = true sees the 'Admin' navigation link in the desktop navbar on the Home page ('/' route)",
        "An authenticated user with isAdmin = true sees the 'Admin' navigation link in the desktop navbar on the Dashboard page ('/dashboard' route)",
        "An authenticated user with isAdmin = true sees the 'Admin' link in the mobile hamburger menu on all routes including '/'",
        "The Admin link does not appear for unauthenticated users on any route",
        "The Admin link does not appear for authenticated users where isAdmin is false or undefined",
        "The useGetCallerUserProfile query runs unconditionally on every route whenever isAuthenticated is true — it is not gated behind a route check",
        "The profile Option returned by the backend is correctly unwrapped (array index [0]) before reading isAdmin",
        "showAdmin is never reset or overridden based on the current route path",
        "All existing navbar styling (Navy Blue #0A1F44 background, white text, hover highlight) is preserved"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/Navbar.tsx",
          "operation": "modify",
          "description": "Completely rewrite the Admin link visibility logic: Remove all existing useIsCallerAdmin, useGetCallerRole, or any route-gated admin check hooks. Replace with a single unconditional call to useGetCallerUserProfile that is enabled whenever isAuthenticated === true, with no route condition or path guard whatsoever. Unwrap the Option returned by the backend (the query returns UserProfile | null in TypeScript, which maps from Motoko's Option — if the result is non-null, read profile.isAdmin directly). Derive showAdmin = userProfile?.isAdmin === true. Render the 'Admin' navigation link in both the desktop nav (<Link to='/admin'>) and the mobile hamburger menu as soon as showAdmin is true, on every route including '/'. Never hide or reset the Admin link based on the current route. The Admin link must remain hidden for unauthenticated users and authenticated non-admin users. Maintain the existing Navy Blue (#0A1F44) and White theme styling throughout. Ensure the profile query is not gated by any route checks — it must run on all routes when the user is authenticated."
        }
      ]
    }
  ]
}